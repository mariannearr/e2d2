<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>
  <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="BD3-LMs">
  <meta name="twitter:description" content="BD3-LMs">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="block diffusion, discrete, masked, diffusion, language models, BD3-LM, BD3-LMs">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Block Diffusion</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

</head>
<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop-wide">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-2 publication-title">Block Diffusion: Interpolating Between Autoregressive and Diffusion Language Models</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://m-arriola.com/" target="_blank">Marianne Arriola</a><sup>1</sup>,</span>
                <span class="author-block">
                  <a href="https://skylion007.github.io/" target="_blank">Aaron Gokaslan</a><sup>1</sup>,</span>
                  <span class="author-block">
                    <a href="https://justinchiu.netlify.app/" target="_blank">Justin Chiu</a><sup>2</sup>,</span>
                      <span class="author-block">
                        <a href="https://zhihanyang2022.github.io/" target="_blank">Zhihan Yang</a><sup>1</sup>,</span>
                        <span class="author-block">
                          <a href="https://zhixuanqi.com/" target="_blank">Zhixuan Qi</a><sup>1</sup>,</span>
                          <span class="author-block">
                            <a href="https://hanjq17.github.io/" target="_blank">Jiaqi Han</a><sup>3</sup>,</span>
                            <span class="author-block">
                              <a href="https://s-sahoo.com/" target="_blank">Subham Sahoo</a><sup>1</sup>,</span>
                  <span class="author-block">
                    <a href="https://www.cs.cornell.edu/~kuleshov/" target="_blank">Volodymyr Kuleshov</a><sup>1</sup>
                  </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><sup>1</sup>Cornell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    <span class="author-block"><sup>2</sup>Cohere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    <span class="author-block"><sup>3</sup>Stanford</span>
                  </div>

                  <div class="is-size-5 publication-flag" style="padding-top: 20px; padding-bottom: 20px;">
                    <b>ICLR 2025 Oral</b>
                  </div>
                  <span class="link-block">
                    <a href="https://arxiv.org/abs/2503.09573" target="_blank"
                       class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file"></i>
                      </span>
                      <span>Paper</span>
                    </a>
                  </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/kuleshov-group/bd3lms" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
                
                <span class="link-block">
                  <a href="https://huggingface.co/collections/kuleshov-group/BD3-LMs-67be95f81b96b15fec50d53f" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <img src="static/images/hf.png" alt="Hugging Face" style="width: 20px; height: 20px; vertical-align: middle;">
                    </span>
                    <span>HuggingFace</span>
                  </a>
                </span>
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser video-->
<section class="hero teaser is-max-desktop">
  <div class="container">
    <div class="hero-body">
      <h2 class="subtitle has-text-centered">
        <strong>Autoregression</strong>: 
        <span style="color: green; padding-left: 10px;">&#9989; High quality</span> 
        <span style="color: green; padding-left: 10px;">&#9989; Arbitrary-length</span>
        <span style="color: green; padding-left: 10px;">&#9989; KV caching</span>
        <span style="color: red; padding-left: 10px;">&#10060; Not parallelizable</span> 
      </h2>
      <img src="static/images/ar.gif" style="padding-bottom: 60px;">

      <h2 class="subtitle has-text-centered">
        <strong>Diffusion</strong>: 
        <span style="color: red; padding-left: 10px;">&#10060; Lower quality</span> 
        <span style="color: red; padding-left: 10px;">&#10060; Fixed-length</span> 
        <span style="color: red; padding-left: 10px;">&#10060; No KV caching</span> 
        <span style="color: green; padding-left: 10px;">&#9989; Parallelizable</span> 
      </h2>
      <img src="static/images/mdlm.gif" style="padding-bottom: 60px;">
      <h2 class="subtitle has-text-centered" style="padding-top: 20px;">
        <!-- <strong>Previous Diffusion LMs</strong>: 
        <span style="color: red; padding-left: 10px;">&#10060; Lower quality</span> 
        <span style="color: red; padding-left: 10px;">&#10060; Fixed-length</span> 
        <span style="color: red; padding-left: 10px;">&#10060; No KV caching</span> 
        <span style="color: green; padding-left: 10px;">&#9989; Parallelizable</span> 
        <br><br> -->
        <strong>Block Diffusion</strong>: 
        <span style="color: green; padding-left: 10px;">&#9989; High quality</span> 
        <span style="color: green; padding-left: 10px;">&#9989; Arbitrary-length</span> 
        <span style="color: green; padding-left: 10px;">&#9989; KV caching</span>
        <span style="color: green; padding-left: 10px;">&#9989; Parallelizable</span> 
      </h2>
      <img src="static/images/bd3.gif" style="padding-bottom: 20px; width:80%;">
      </div>
  </div>
</section>
<!-- End teaser video -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Diffusion language models offer unique benefits over autoregressive models due to their potential for parallelized generation and controllability, yet they lag in likelihood modeling and are limited to fixed-length generation. In this work, we introduce a class of block diffusion language models that interpolate between discrete denoising diffusion and autoregressive models. Block diffusion overcomes key limitations of both approaches by supporting flexible-length generation and improving inference efficiency with KV caching and parallel token sampling. We propose a recipe for building effective block diffusion models that includes an efficient training algorithm, estimators of gradient variance, and data-driven noise schedules to minimize the variance. Block diffusion sets a new state-of-the-art performance among diffusion models on language modeling benchmarks and enables generation of arbitrary-length sequences.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- AR VS DIFFUSION -->
<section class="section" id="SEC1">
  <div class="container is-max-desktop content">
    <div class="content is-medium">
      <h2 class="title">Autoregressive vs. Diffusion Language Models</h2>
      <p>
        In the language modeling task, we have a sequence of \( L \) tokens \( \mathbf{x} = (\mathbf{x}^1, \dots, \mathbf{x}^L ) \) drawn from the data distribution \( q(\mathbf{x}) \). We aim to fit a model \( p_\theta(\mathbf{x}) \) of \( q \).
      </p>
        Autoregressive models define a factorized distribution of the form:
      </p>
      <p>
        \[ \log p_\theta(\mathbf{x}) = \sum_{\ell=1}^L \log p_\theta(\mathbf{x}^\ell \mid \mathbf{x}^{\lt \ell}) \]
      </p>
      <p>However, the sequential dependencies between tokens require that AR sampling is restricted to \( L \) sampling steps, which may be slow for long sequences.</p>
      <p>Diffusion models overcome this limitation by modeling tokens independently, admitting parallel generation. Diffusion models instead fit a model to undo a forward corruption process \( q(\mathbf{x}_t | \mathbf{x}_{t-1}) = \text{Cat}(\mathbf{x_t} ; Q_t \mathbf{x}_{t-1} ) \) using transition matrices \( Q_t \). D3PM (<a href="https://arxiv.org/abs/2107.03006">Austin et. al</a>) defines this as</p>
      <p>
        \[ p_\theta(\mathbf{x}_s | \mathbf{x}_t) = \prod_{\ell=1}^L p_\theta (\mathbf{x}_s^\ell | \mathbf{x}_t) = \sum_{\mathbf{x}} \left[q(\mathbf{x}_s^{\ell} | \mathbf{x}_t^\ell, \mathbf{x}^\ell) p_\theta(\mathbf{x}^{\ell} | \mathbf{x}_t)  \right] \]
      </p>
      <p>where the denoising base model \( p_\theta(\mathbf{x}^\ell | \mathbf{x}_t) \) predicts clean token \( \mathbf{x}^\ell \) given noised tokens \( \mathbf{x}_t \). However, the diffusion objective minimizes a bound on the likelihood. As a result, diffusion models lag in terms of likelihood and sample quality. Furthermore, diffusion models are restricted to generate fixed length sequences.</p>
    </div>
  </div>
</section>

<!-- BD3-LMs -->
<style>
      /* .link-block {
          display: inline-block;
          text-align: center;
          margin: 4px;
          font-size: 1.1em;
        }

        .link-block .external-link.button {
          font-size: 0.9em;
        }

        .link-block .icon {
          font-size: 1.2em;
        } */

      .container.is-max-desktop {
          max-width: 50%; /* Increase the width */
          width: 50%;
      }
      .container.is-max-desktop-wide {
          max-width: 65%; /* Increase the width */
          width: 65%;
      }
      .section {
            padding-left: 5%;
            padding-right: 5%;
        }
        .hero-body {
          display: flex;
          flex-direction: column; /* Captions and figure container are in a vertical stack */
          align-items: center;
      }
      
      .subtitle.has-text-centered {
          font-size: 1.3em; /* Increase font size */
      }

        p {
          font-size: 18px;
        }

        .author-block {
          font-size: 18px;
        }


      

        .figure-caption-container {
            display: flex;
            flex-direction: column; /* Captions and figure container are in a vertical stack */
            align-items: center;
            gap: 20px; /* Spacing between figure and color captions */
        }

        .figure-content-container {
            display: flex;
            flex-direction: row; /* Figure and color boxes are side by side */
            align-items: center;
            gap: 20px;
        }

        .figure-container {
            flex-shrink: 0; /* Prevents figure from shrinking */
        }

        .captions {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
        }

        .caption {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .title {
          padding-bottom: 10px;
          font-size: 25px;
        }
        /* centers the title, minimize width of container */
        /* .publication-title {
          text-align: center;
          max-width: 100%;
        } */
  .color-box {
      display: inline-block;
      width: 20px;
      height: 20px;
      margin-right: 5px;
      vertical-align: middle;
  }
  .orange { background-color: #ff9900; }
  .light-orange { background-color: #FFDAB9; }
  .blue { background-color: #30beee; }
  .dark-green { background-color: #006400; }
  .green { background-color: #228B22; }
  .light-green { background-color: #90EE90; }
</style>
<style>
  table {
    width: 50%; /* Reduce overall table width */
    margin: 10px auto;
    border-collapse: collapse;
    font-size: 18px; /* Reduce font size */
  }

  th, td {
    padding: 4px 6px; /* Reduce padding */
    border: 1px solid #ddd; /* Keep border for readability */
    text-align: center;
  }

  th {
    background-color: #f2f2f2;
  }

  .figure-caption {
    font-size: 18px; /* Reduce caption font size */
  }
</style>


<section class="section" id="SEC2">
  <div class="container is-max-desktop">
    <div class="content is-medium">
      <h2 class="title">BD3-LMs: Block Discrete Denoising Diffusion Language Models</h2>
      <p>We combine modeling paradigms to enjoy better likelihoods & flexible-length generation from autoregressive models, as well as fast & parallel generation from diffusion models.</p> 
      <h4 class="subtitle">Block Diffusion Likelihood</h4>
      <p>We propose a modeling framework that autoregressively models blocks of tokens and performs diffusion within each block. Our likelihood factorizes over \( B \) blocks of length \( L' \) as</p>
      <p>
        \[ \log p_\theta (\mathbf{x}) = \sum_{b=1}^B \log p_\theta (\mathbf{x}^b | \mathbf{x}^{\lt b}) \]
      </p>
      <p>Each \( p_\theta (\mathbf{x}^b | \mathbf{x}^{\lt b}) \) is modeled using discrete diffusion ELBO over a block of \( L' \) tokens. We obtain a principled learning objective \( \mathcal{L}_\text{BD}(\mathbf{x}, \theta) \) by optimizing the following likelihood bound:</p>
      <p>
        \[ \log p_\theta(\mathbf{x}) \geq \mathcal{L}_\text{BD}(\mathbf{x}, \theta) := \sum_{b=1}^{B} \mathcal{L}_{\text{diffusion}}(\mathbf{x}^b, \mathbf{x}^{\lt b}, \theta), \]
      </p>
      We model the per-block likelihood under a simple discrete diffusion parameterization (<a href="https://arxiv.org/abs/2406.07524">Sahoo et. al</a>, <a href="https://arxiv.org/abs/2406.04329">Shi et. al</a>, <a href="https://arxiv.org/abs/2406.03736">Ou et. al</a>). Our final objective becomes a sum of weighted cross-entropy terms:
      <p>
        \[ \mathcal{L}_\text{BD}(\mathbf{x}, \theta) :=  - \sum_{b=1}^{B} \mathbb{E}_{t \sim [0, 1]} \mathbb{E}_{q} \frac{1}{t} \log p_\theta(\mathbf{x}^b | \mathbf{x}_{t}^b, \mathbf{x}^{\lt b}) \]
      </p>
      <h4 class="subtitle">Efficient Training & Sampling Algorithms</h4>
      <p> Naively, we would compute the logits by applying \( \mathbf{x}_\theta^b( \mathbf{x}_t^b, \mathbf{K}^{1:b\text{-}1}, \mathbf{V}^{1:b\text{-}1}) \) in a loop \( B\) times. Instead, we only require two forward passes. The first pass precomputes keys and values \( \mathbf{K}^{1:B}, \mathbf{V}^{1:B} \) for the full sequence \( \mathbf{x}\). In the second forward pass, we compute denoised predictions for all blocks simulatenously using  \( \mathbf{x}_\theta^b( \mathbf{x}_t^b, \mathbf{K}^{1:b\text{-}1}, \mathbf{V}^{1:b\text{-}1}) \). </p>
      <p> To sample from BD3-LMs, we generate one block at a time, conditioned on previously sampled blocks. After generating a block, we cache its keys and values, similar to AR. We may use any diffusion sampling procedure \( \text{SAMPLE} ( \mathbf{x}_\theta^b, \mathbf{K}^{1:b\text{-}1}, \mathbf{V}^{1:b\text{-}1}) \) to sample from the conditional distribution \( p_\theta (\mathbf{x}_s^b | \mathbf{x}_t^b, \mathbf{x}^{ < b}) \) over \( T\) sampling steps per block.</p>
      <section class="hero is-small">
        <div class="hero-body">
        <img src="static/images/alg.png" alt="mask" style="width:80%; padding-bottom: 10px;">
        <div class="figure-caption" style="padding-bottom: 10px;">
          <i>BD3-LM training and sampling algorithms.</i>
      </div>
        </div>
      </section>
    </div>
  </div>
</section>

<!-- GAP -->
<section class="section" id="SEC2">
  <div class="container is-max-desktop content">
    <div class="content is-medium">
      <h2 class="title">Understanding Likelihood Gaps Between Diffusion and AR Models</h2>
      <h4 class="subtitle">Case Study: Single Token Generation</h4>
      <p>Our block diffusion parameterization is equivalent in expectation to the autoregressive NLL in the limiting case where \( L'=1 \). Surprisingly, we find a two point perplexity gap between our block diffusion model for \( L'=1 \) and AR when training both models on the LM1B dataset. We identify high training variance of the diffusion objective as responsible for the perplexity gap.</p>
      <section class="hero is-small">
        <div class="hero-body">
        <img src="static/images/bs1.png" alt="mask" style="width:80%; padding-bottom: 10px;">
        <div class="figure-caption" style="padding-bottom: 10px;">
          <i>Training under the discrete diffusion ELBO suffers from high variance.</i>
      </div>
        </div>
      </section>
      <h4 class="subtitle">Diffusion Gap from High Variance Training</h4>
        <p>Intuitively, if the sampled masking rate \( t \sim \mathcal{U}[0, 1] \) is too low, reconstructing \( \mathbf{x} \) is easy, which does not provide a useful learning signal. If we mask everything, the optimal reconstruction are the marginals of each token in the data distribution, which is easy to learn, and again not useful.</p>
        We seek to find noise schedules that minimize training variance caused by the diffusion objective and further reduce the perplexity gap.</p>
      </div>
  </div>
</section>

<!-- CLIPPED SCHEDULES -->
<section class="section" id="SEC2">
  <div class="container is-max-desktop content">
    <div class="content is-medium">
      <h2 class="title">Data-Driven Noise Schedules for Low-Variance Training</h2>
      <p>To avoid masking rates that cause high-variance training, we train BD3-LMs under "clipped" masking rates \( t \sim \mathcal{U}[\beta, \omega] \) for \( 0 \leq \beta, \omega \leq 1 \). By reducing the training variance, we improve likelihoods when we evaluate under uniformly sampled mask rates.</p>

      <p>As the optimal mask rates may differ depending on the block size \(L'\), we adaptively learn \( \beta, \omega \) during training. In practice, we do so using a grid search during every validation step, after 5K gradient updates, to optimize \(\min_{\beta, \omega} \text{Var}_{\mathbf{X}, t} \left[ \mathcal{L}_{\text{BD}}(\theta, \beta, \omega; \mathbf{X}) \right] \). </p>
      
      <p>Below, we show that optimizing the noise schedule per block size reduces the variance of the loss estimator and achieves the best perplexities compared to alternative schedules.</p>
    </div>

    <table style="width: 80%; margin: 20px auto; border-collapse: collapse; font-size: 18px; text-align: center;">
      <div class="figure-caption">
        <center>
        <i style="font-size: 19px;">Effect of training under different noise schedules on perplexity (PPL  ↓) on LM1B. All models are finetuned for 50K steps and are evaluated under uniformly sampled mask rates. For our clipped schedules, we compare the optimized clipping rates for \( L'=4, 16 \).</i>
        </center>
      </div>
      <tr>
          <th style="padding: 6px 10px; border-bottom: 1px solid #ddd; background-color: #f2f2f2;">BD3-LMs</th>
          <th style="padding: 6px 10px; border-bottom: 1px solid #ddd; background-color: #f2f2f2;">Noise schedule</th>
          <th style="padding: 6px 10px; border-bottom: 1px solid #ddd; background-color: #f2f2f2;">PPL</th>
          <th style="padding: 6px 10px; border-bottom: 1px solid #ddd; background-color: #f2f2f2;">Var. ELBO</th>
      </tr>
  
      <!-- Multi-row for L' = 4 -->
      <tr>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd; font-weight: bold; vertical-align: middle;" rowspan="4">L' = 4</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">Linear <em>t</em> ~ <em>U</em>[0, 1]</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">30.18</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">23.45</td>
      </tr>
      <tr>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd; font-weight: bold;">Clipped <em>t</em> ~ <em>U</em>[0.45, 0.95]</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd; font-weight: bold;">29.21</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd; font-weight: bold;">6.24</td>
      </tr>
      <tr>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">Clipped <em>t</em> ~ <em>U</em>[0.3, 0.8]</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">29.38</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">10.33</td>
      </tr>
      <tr>
          <td style="padding: 6px 10px; border-bottom: 2px solid #ddd;">Logarithmic</td>
          <td style="padding: 6px 10px; border-bottom: 2px solid #ddd;">30.36</td>
          <td style="padding: 6px 10px; border-bottom: 2px solid #ddd;">23.53</td>
      </tr>
  
      <!-- Multi-row for L' = 16 -->
      <tr>
          <td style="padding: 6px 10px; border-bottom: none; font-weight: bold; vertical-align: middle;" rowspan="4">L' = 16</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">Linear <em>t</em> ~ <em>U</em>[0, 1]</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">31.72</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">7.62</td>
      </tr>
      <tr>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">Clipped <em>t</em> ~ <em>U</em>[0.45, 0.95]</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">31.42</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd;">3.60</td>
      </tr>
      <tr>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd; font-weight: bold;">Clipped linear <em>t</em> ~ <em>U</em>[0.3, 0.8]</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd; font-weight: bold;">31.12</td>
          <td style="padding: 6px 10px; border-bottom: 1px solid #ddd; font-weight: bold;">3.58</td>
      </tr>
      <tr>
          <td style="padding: 6px 10px; border-bottom: none;">Cosine</td>
          <td style="padding: 6px 10px; border-bottom: none;">31.41</td>
          <td style="padding: 6px 10px; border-bottom: none;">13.00</td>
      </tr>
  </table>
  </div>
</section>

<!-- RESULTS -->
<section class="section" id="SEC2">
  <div class="container is-max-desktop content">
    <div class="content is-medium">
      <h2 class="title">Results</h2>
      <h4 class="subtitle">Likelihood Evaluation</h4>
      <p>BD3-LMs achieve state-of-the-art likelihoods among diffusion models. As shown below, BD3-LMs interpolate between diffusion and autoregressive likelihoods by tuning the block length \( L' \). </p>
      <style>
        img {
          width: 80%;
        }
        table {
          border-collapse: collapse;
          width: 100%;
        }
        th, td {
          padding: 8px;
          text-align: left;
        }
        /* Top border for category headers, without bottom border */
        tr.category-row td {
          border-top: 2px solid #000;
          border-bottom: none;
        }
        /* Bold top border for the block-diffusion section */
        tr.block-diffusion-row td {
          border-top: 2px solid #000; /* Bold border */
          border-bottom: none;
        }
        /* Remove bottom borders for grouped models */
        tr.grouped-models td {
          border-bottom: none;
        }
        /* Light bottom border specifically for the last row in block-diffusion */
        tr.final-row td {
          border-bottom: 2px solid #000; /* Light border */
        }
        /* Make BD3-LMs invisible */
        .invisible {
          visibility: hidden; /* Makes text invisible but preserves space */
        }
      </style>
      <style>
        .compact-table {
            max-width: 400px;  /* Adjust width as needed */
            width: 100%;
            margin: auto;
            border-collapse: collapse;
        }
        .compact-table th, .compact-table td {
            padding: 5px 10px;  /* Reduce padding */
            text-align: left;
            white-space: nowrap; /* Prevent wrapping */
        }
        .compact-table th {
            background-color: #f2f2f2; /* Light gray header */
        }
    </style>
      <table class="compact-table">
            <center>
                <i>Test perplexities (PPL; ↓) on OWT for models trained for 262B tokens.</i>
            </center>
        </div>
        <thead>
            <tr>
                <th>Model</th>
                <th>PPL (↓)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>AR</td>
                <td>17.54</td>
            </tr>
            <tr>
                <td>SEDD</td>
                <td>≤ 24.10</td>
            </tr>
            <tr>
                <td>MDLM</td>
                <td>≤ 22.98</td>
            </tr>
            <tr>
                <td><strong>BD3-LMs</strong> L' = 16</td>
                <td>≤ 22.27</td>
            </tr>
            <tr>
                <td><span class="invisible">BD3-LMs</span> L' = 8</td>
                <td>≤ 21.68</td>
            </tr>
            <tr>
                <td><span class="invisible">BD3-LMs</span> L' = 4</td>
                <td><strong>≤ 20.73</strong></td>
            </tr>
        </tbody>
    </table>

      <h4 class="subtitle" style="margin-top: 40px;">Arbitrary-length sequence generation</h4>
      <p>One key drawback of many existing diffusion language models is that they cannot generate full-length documents that are longer than the length of the output context chosen at training time. For example, OpenWebText contains documents up to 131K tokens, whereas discrete diffusion model SEDD (<a href="https://arxiv.org/abs/2310.16834">Lou et. al</a>) is restricted to generate 1024 tokens. Below, we show that BD3-LMs can generate variable-length documents by decoding an arbitrary number of blocks.</p>
      
      <table class="compact-table" style="margin-bottom: 40px;">
        <div class="figure-caption">
        <center>
          <i>Generation length statistics from sampling 500 documents from models trained on OWT.</i>
        </center>
      </div>
        <thead>
          <tr>
            <th></th>
            <th>Median # tokens</th>
            <th>Max # tokens</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>OWT train set</td>
            <td>717</td>
            <td>131K</td>
          </tr>
          <tr>
            <td>AR</td>
            <td>4008</td>
            <td>131K</td>
          </tr>
          <tr>
            <td>SEDD</td>
            <td>1021</td>
            <td>1024</td>
          </tr>
          <tr>
            <td><strong>BD3-LM</strong> L'=16</td>
            <td>798</td>
            <td>9982</td>
          </tr>
        </tbody>
      </table>
      
      
      <p> We assess the generation quality of BD3-LMs on variable-length sequences, comparing all methods using the same number of generation steps (NFEs). Below, we measure the generative perplexity of sampled sequences under GPT2-Large. BD3-LMs achieve the best generative perplexities compared to all previous diffusion methods.</p>


      <!-- <p>We also compare with SSD-LM (<a href="https://arxiv.org/abs/2210.17432">Han et. al</a>), an alternative block-autoregressive formulation that performs Gaussian diffusion over word embeddings, as in other works such as Diffusion-LM (<a href="https://arxiv.org/abs/2205.14217">Li et. al</a>). Our approach instead applies discrete noise and can be seen as the analogous extension of <a href="https://arxiv.org/abs/2107.03006">Austin et. al</a>. Unlike BD3-LMs, SSD-LM does not support likelihood estimation. Thus, to compare the models, we generated unconditionally sequences of lengths 1024 and 2048. Our discrete approach yields samples with improved generative perplexity using an order magnitude fewer generation steps.</p> -->
        
      <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center; /* Center align all table entries */
            vertical-align: middle;
        }
        th {
            background-color: #f2f2f2;
        }
        caption {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
    <table style="border-collapse: collapse; width: 100%; margin-bottom:40px;">
      <div class="figure-caption">
        <center>
          <i>Generative perplexity (Gen. PPL; ↓) and number of function evaluations (NFEs; ↓) of 300 variable-length samples. All models are trained on OWT with a context length L = 1024 and use nucleus sampling.</i>
        </center>
      </div>
      <thead>
        <tr>
          <th>Category</th>
          <th>Model</th>
          <th colspan="2"><center>L = 1024</center></th>
          <th colspan="2"><center>L = 2048</center></th>
        </tr>
        <tr>
          <th style="padding: 8px;"></th>
          <th style="padding: 8px;"></th>
          <th>Gen. PPL (↓)</th>
          <th>NFEs</th>
          <th>Gen. PPL (↓)</th>
          <th>NFEs</th>
        </tr>
      </thead>
      <tbody>
        <!-- Autoregressive Section -->
        <tr>
          <td style="border-bottom: 2px solid black; text-align: left; padding: 8px;"><i>Autoregressive</i></td>
          <td style="border-bottom: 2px solid black; padding: 8px;">AR</td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>14.1</center></td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>1K</center></td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>13.2</center></td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>2K</center></td>
        </tr>
    
        <!-- Diffusion Section -->
        <tr>
          <td style="border-bottom: 2px solid black; text-align: left; padding: 8px;" rowspan="2"><i>Diffusion</i></td>
          <td style="padding: 8px;">SEDD</td>
          <td style="padding: 8px;"><center>52.0</center></td>
          <td style="padding: 8px;"><center>1K</center></td>
          <td style="padding: 8px;"><center>-</center></td>
          <td style="padding: 8px;"><center>-</center></td>
        </tr>
        <tr>
          <td style="border-bottom: 2px solid black; padding: 8px;">MDLM</td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>46.8</center></td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>1K</center></td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>41.3</center></td>
          <td style="border-bottom: 2px solid black; padding: 8px;"><center>2K</center></td>
        </tr>
        
        <!-- Block-diffusion Section -->
        <tr>
          <td style="border-bottom: none; text-align: left; padding: 8px;" rowspan="5"><i>Block diffusion</i></td>
          <td style="border-bottom: none; padding: 8px;">SSD-LM L' = 25</td>
          <td style="border-bottom: none; padding: 8px;"><center>37.2</center></td>
          <td style="border-bottom: none; padding: 8px;"><center>40K</center></td>
          <td style="border-bottom: none; padding: 8px;"><center>35.3</center></td>
          <td style="border-bottom: none; padding: 8px;"><center>80K</center></td>
        </tr>
        <tr>
          <td style="padding: 8px;"></td>
          <td style="border-top: none; padding: 8px;"><center>281.3</center></td>
          <td style="border-top: none; padding: 8px;"><center>1K</center></td>
          <td style="border-top: none; padding: 8px;"><center>261.9</center></td>
          <td style="border-top: none; padding: 8px;"><center>2K</center></td>
        </tr>
        <tr>
          <td style="border-top: 1px solid #000000; padding: 8px;border-bottom: none;"><strong>BD3-LMs</strong> L' = 16</td>
          <td style="padding: 8px;border-bottom: none;"><center>33.4</center></td>
          <td style="padding: 8px;border-bottom: none;"><center>1K</center></td>
          <td style="padding: 8px;border-bottom: none;"><center>31.5</center></td>
          <td style="padding: 8px;border-bottom: none;"><center>2K</center></td>
        </tr>
        <tr>
          <td style="padding: 8px;border-bottom: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; L' = 8</td>
          <td style="padding: 8px;border-bottom: none;"><center>30.4</center></td>
          <td style="padding: 8px;border-bottom: none;"><center>1K</center></td>
          <td style="padding: 8px;border-bottom: none;"><center>28.2</center></td>
          <td style="padding: 8px;border-bottom: none;"><center>2K</center></td>
        </tr>
        <tr>
          <td style="padding: 8px;" class="highlight">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L' = 4</td>
          <td style="padding: 8px;" class="highlight"><center><strong>25.7</strong></center></td>
          <td style="padding: 8px;"><center>1K</center></td>
          <td style="padding: 8px;" class="highlight"><center><strong>23.6</strong></center></td>
          <td style="padding: 8px;"><center>2K</center></td>
        </tr>
        
      </tbody>
    </table>
    <p>For MDLM, we use their block-wise decoding technique (which does not feature block diffusion training as in BD3-LMs) for L=2048. We also compare to SSD-LM (<a href="https://arxiv.org/abs/2210.17432">Han et. al</a>) an alternative block-autoregressive method (also known as semi-autoregression) that performs Gaussian diffusion over word embeddings but cannot perform likelihood estimation. Our discrete approach yields samples with improved generative perplexity using an order of magnitude fewer generation steps.</p>

    </div>
  </div>
</section>


<!-- CONCLUSION -->
<section class="section" id="SEC2">
  <div class="container is-max-desktop content">
    <div class="content is-medium">
      <h2 class="title">Conclusion</h2>
      <p>We presented Block Discrete Diffusion Language models, a new model class that combines strength of both autoregressive and diffusion approaches while overcoming their limitations. Block diffusion overcomes key drawbacks of existing discrete diffusion models: the quality gap to AR model and their inability to generate arbitrary-length sequences or support KV caching. By doing so, BD3-LMs set a new state-of-the-art among discrete diffusion models. Our work presents a promising step forward in building powerful diffusion language models that are competitive with standard LLMs, while offering parallel token generation and improved controllability of samples.</p>
    </div>
  </div>
</section>




<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>
        @inproceedings{
          arriola2025interpolating,
          title={Interpolating Autoregressive and Discrete Denoising Diffusion Language Models},
          author={Marianne Arriola and Aaron Gokaslan and Justin T Chiu and Jiaqi Han and Zhihan Yang and Zhixuan Qi and Subham Sekhar Sahoo and Volodymyr Kuleshov},
          booktitle={The Thirteenth International Conference on Learning Representations},
          year={2025},
          url={https://openreview.net/forum?id=tyEyYT267x}
        }
      </code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>